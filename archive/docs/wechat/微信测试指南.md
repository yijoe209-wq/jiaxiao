# 📱 微信内完整测试指南

## 🎯 测试目标

在微信内置浏览器中完整测试 MVP 功能:
1. ✅ 多选群消息(文本+图片)
2. ✅ AI 智能解析任务
3. ✅ 任务确认和分配
4. ✅ 任务查看和管理

---

## 🚀 快速开始

### 第一步:获取测试链接

**您的专属测试地址 (Cloudflare Tunnel):**

```
https://achievement-senior-any-manchester.trycloudflare.com
```

⚠️ **重要:** 这是一个 HTTPS 地址,可以在微信中直接访问!

---

## 📋 完整测试流程

### 方法 1: 在微信中测试(推荐)

#### 步骤 1: 打开测试页面

1. **在微信中发送给自己以下链接:**
   ```
   https://achievement-senior-any-manchester.trycloudflare.com/simulate
   ```

2. **点击链接**,会在微信内置浏览器中打开模拟转发页面

#### 步骤 2: 准备测试数据

**场景 A: 纯文本任务(最简单)**

点击"使用此示例"按钮,会自动填充以下内容:
```
语文任务:
1.阅读打卡:
朗读《语文园地八》这课,会认字和会写字口头拼读并组词。

朗读课外读物,写阅读笔记。

2.背诵课本1--8单元要求背诵的所有内容。
背诵课本105页的成语和日积月累,录音上传小管家。

3.认真修改作业本里面的错误。
```

**场景 B: 文本 + 图片任务(完整功能)**

1. **文本内容:**
   ```
   语文作业:

   1. 完成练习册第10-12页
   2. 背诵《山行》古诗
   3. 预习下一课内容

   详见图片
   ```

2. **添加图片:**
   - 点击"📷 点击选择图片"
   - 从手机相册选择作业图片(最多支持多张)
   - 等待上传完成

**场景 C: 真实场景测试**

1. **在微信群中:**
   - 长按老师的消息
   - 选择"多选"
   - 勾选多条消息(文本+图片)
   - 点击"转发" → "文件传输助手"

2. **复制内容:**
   - 在文件传输助手中长按消息
   - 选择"复制文字"
   - 保存图片(长按 → 保存)

3. **在测试页面:**
   - 粘贴文字内容
   - 点击"选择图片"上传保存的图片
   - 点击"模拟转发"

#### 步骤 3: AI 智能解析

点击"📤 模拟转发给AI助手"按钮:

**预期结果:**
```
✅ 解析结果

✅ 已识别 7 条任务

👉 点此确认任务
```

#### 步骤 4: 确认任务(关键步骤)

**点击"👉 点此确认任务"链接**

会打开任务确认页面,显示:
- ✅ 已识别的 7 条任务详情
- 每条任务的类型、描述
- 学生选择选项

#### 步骤 5: 分配给学生

1. **选择学生:**
   - ○ 小明 (三年级)
   - ○ 小红 (一年级)

2. **查看任务列表:**
   ```
   1. [阅读] 朗读《语文园地八》...
   2. [背诵] 背诵课本1-8单元...
   3. [其他] 认真修改作业本...
   ...
   ```

3. **点击"✓ 确认并创建任务"**

#### 步骤 6: 查看任务列表

确认成功后:
- ✅ 看到"✓ 任务已成功创建!"
- 3秒后自动跳转到任务列表
- 可以查看所有未完成任务

---

## 🔗 其他测试页面

### 1. 任务管理页面
```
https://achievement-senior-any-manchester.trycloudflare.com/tasks
```

功能:
- 查看所有学生的任务
- 按学生筛选
- 标记任务完成
- 查看任务详情

### 2. 系统监控页面
```
https://achievement-senior-any-manchester.trycloudflare.com/
```

功能:
- 查看系统状态
- 数据库连接状态
- LLM API 配置状态

### 3. 健康检查
```
https://achievement-senior-any-manchester.trycloudflare.com/health
```

返回 JSON:
```json
{
  "status": "ok",
  "checks": {
    "database": "ok",
    "llm_api": "configured"
  }
}
```

---

## 🧪 测试场景清单

### 场景 1: 简单单条任务 ✅
**目标:** 验证基本功能

**测试数据:**
```
明天背诵《山行》古诗
```

**预期结果:**
- ✅ 识别为 1 条任务
- ✅ 任务类型: 背诵
- ✅ 确认页面正常显示

---

### 场景 2: 复合多任务 ✅
**目标:** 验证 AI 解析能力

**测试数据:**
使用示例消息(7条任务)

**预期结果:**
- ✅ 识别为 7 条任务
- ✅ 任务类型准确(阅读/背诵/书写/其他)
- ✅ 任务描述清晰
- ✅ 置信度评分正确

---

### 场景 3: 文本 + 图片任务 ✅
**目标:** 验证图片处理功能

**测试步骤:**
1. 输入简单文字描述
2. 上传 2-3 张作业图片
3. 点击模拟转发

**预期结果:**
- ✅ 图片上传成功
- ✅ 图片在任务详情中显示
- ✅ 任务正常创建

---

### 场景 4: 只有图片的任务 ✅
**目标:** 验证纯图片场景

**测试步骤:**
1. 不输入任何文字
2. 只上传图片
3. 点击模拟转发

**预期结果:**
- ⚠️ 提示"消息内容和图片不能同时为空"
- 或创建任务(如果实现 OCR)

---

### 场景 5: 多学生分配 ✅
**目标:** 验证学生选择功能

**测试步骤:**
1. 创建任务后选择"小明"
2. 再创建同样的任务选择"小红"

**预期结果:**
- ✅ 两个学生各自有独立的任务列表
- ✅ 任务不相互干扰

---

### 场景 6: 任务完成标记 ✅
**目标:** 验证任务状态管理

**测试步骤:**
1. 查看任务列表
2. 点击"完成"按钮
3. 刷新页面

**预期结果:**
- ✅ 任务状态变为"已完成"
- ✅ 任务从"未完成"列表消失
- ✅ 可以在"已完成"中查看

---

## ⚠️ 微信内测试注意事项

### 1. 域名安全提示

微信可能提示:
```
非微信官方网页
点击继续访问
```

**解决方法:** 点击"继续访问"即可

### 2. 链接有效期

⚠️ **重要:** 待确认任务 24 小时后过期

**过期后:**
- 重新发送消息获取新链接
- 或访问 `/simulate` 重新测试

### 3. 图片上传限制

- 单张图片最大 16MB
- 支持格式: JPG、PNG、GIF、WEBP
- 建议上传前压缩图片

### 4. 网络要求

- 需要稳定的网络连接
- Cloudflare Tunnel 在全球有 CDN
- 一般 2-3 秒即可加载

---

## 📊 测试记录表

### 功能测试

| 功能 | 测试场景 | 测试结果 | 问题描述 |
|------|---------|---------|---------|
| 文本解析 | 简单单条任务 | ⬜ 通过 / ❌ 失败 | |
| 文本解析 | 复合多任务(7条) | ⬜ 通过 / ❌ 失败 | |
| 图片上传 | 单张图片 | ⬜ 通过 / ❌ 失败 | |
| 图片上传 | 多张图片(3+) | ⬜ 通过 / ❌ 失败 | |
| AI解析 | 准确率评估 | ⬜ ≥85% / ❌ <85% | |
| 确认页面 | 任务显示 | ⬜ 通过 / ❌ 失败 | |
| 确认页面 | 学生选择 | ⬜ 通过 / ❌ 失败 | |
| 任务创建 | 成功创建 | ⬜ 通过 / ❌ 失败 | |
| 任务列表 | 查看任务 | ⬜ 通过 / ❌ 失败 | |
| 任务完成 | 标记完成 | ⬜ 通过 / ❌ 失败 | |

### 体验评分

| 体验项 | 评分(1-5) | 备注 |
|--------|----------|------|
| 操作便捷性 | ⬜⬜⬜⬜⬜ | |
| 页面加载速度 | ⬜⬜⬜⬜⬜ | |
| UI美观度 | ⬜⬜⬜⬜⬜ | |
| 功能完整性 | ⬜⬜⬜⬜⬜ | |
| 整体满意度 | ⬜⬜⬜⬜⬜ | |

---

## 🎯 测试成功标准

### 最小可用产品(MVP)验收标准

✅ **必须满足:**

1. **AI 解析准确率 ≥ 85%**
   - 测试 10 条真实老师消息
   - 至少 8 条解析正确

2. **完整流程可用**
   - 发送消息 → AI 解析 → 确认 → 创建任务
   - 全程无错误,总耗时 < 30 秒

3. **微信内体验良好**
   - 在微信内置浏览器中流畅运行
   - 页面加载 < 3 秒
   - 无明显卡顿

4. **任务管理功能**
   - 可以查看任务列表
   - 可以标记完成
   - 可以按学生筛选

---

## 🐛 问题反馈

如果测试过程中遇到问题:

### 1. 检查服务状态

访问健康检查:
```
https://achievement-senior-any-manchester.trycloudflare.com/health
```

**应该返回:**
```json
{"status":"ok"}
```

### 2. 常见问题

**Q: 点击链接打不开?**
- 检查网络连接
- 尝试长按链接选择"在浏览器中打开"
- 确认 Cloudflare Tunnel 是否运行

**Q: AI 解析失败?**
- 检查 LLM API Key 配置
- 查看消息格式是否正确
- 尝试简化消息内容

**Q: 图片上传失败?**
- 检查图片大小(< 16MB)
- 检查图片格式(JPG/PNG/GIF)
- 尝试压缩图片后重试

**Q: 任务确认页面无响应?**
- 刷新页面重试
- 检查 pending_id 是否过期(24小时)
- 查看浏览器控制台错误

### 3. 查看详细日志

```bash
# 在本地项目目录
tail -f logs/app.log
```

---

## 🚀 下一步计划

### 测试通过后

1. **优化 AI Prompt**
   - 根据测试结果调整解析逻辑
   - 提高准确率

2. **完善功能**
   - 添加任务编辑功能
   - 添加批量操作
   - 优化移动端体验

3. **准备生产部署**
   - 购买云服务器
   - 注册域名
   - 配置微信公众号

---

## 📞 技术支持

- **项目地址:** `/Volumes/data/vibe-coding-projects/jiaxiao`
- **健康检查:** `/health`
- **系统指标:** `/metrics`
- **测试页面:** `/simulate`

---

## ✨ 准备开始测试!

**第一步:** 在微信中打开以下链接
```
https://achievement-senior-any-manchester.trycloudflare.com/simulate
```

**第二步:** 点击"使用此示例"或粘贴真实消息

**第三步:** 点击"模拟转发"体验 AI 解析

**第四步:** 点击确认链接,体验完整流程

**开始测试吧!** 🎉
