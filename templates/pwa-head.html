<!-- PWA Meta Tags -->
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#1a1a1a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="家校助手">
<link rel="apple-touch-icon" href="/static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="192x192" href="/static/icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/static/icon-512.png">
<link rel="shortcut icon" href="/static/favicon.ico">

<!-- PWA Install Prompt Script -->
<script>
// PWA 安装提示
let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {
    console.log('PWA: 收到安装提示');
    e.preventDefault();
    deferredPrompt = e;

    // 显示安装按钮（可选）
    const installBtn = document.getElementById('pwa-install-btn');
    if (installBtn) {
        installBtn.style.display = 'block';
        installBtn.addEventListener('click', () => {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('PWA: 用户接受安装');
                } else {
                    console.log('PWA: 用户拒绝安装');
                }
                deferredPrompt = null;
            });
        });
    }
});

// 检测是否已安装
window.addEventListener('appinstalled', () => {
    console.log('PWA: 应用已安装');
    const installBtn = document.getElementById('pwa-install-btn');
    if (installBtn) {
        installBtn.style.display = 'none';
    }
});
</script>
